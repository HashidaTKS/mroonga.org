<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>9.2. Release procedure &#8212; Mroonga v9.11 documentation</title>
    <link rel="stylesheet" href="../static/mroonga.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/language_data.js"></script>
    
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9.3. コーディングスタイル" href="coding_style.html" />
    <link rel="prev" title="9.1. How to debug" href="debug.html" /> 
      <meta property="fb:page_id" content="238184682903165" /><!-- mroonga -->
    <meta property="fb:admins" content="664204556" /><!-- kouhei.sutou -->
    <meta property="og:type" content="product" />
    <meta property="og:image" content="http://mroonga.org/images/logos/mroonga-icon-full-size.png" />
    <meta property="og:site_name" content="mroonga" />

    <link rel="stylesheet" href="/css/sphinx.css" type="text/css" />
  </head>
  <body>
    <div id="fb-root"></div>

<div class="header">
  <h1 class="title">
    <a id="top-link" href="../../">
      <span class="project">mroonga</span>
      <span class="separator">-</span>
      <span class="description">An open-source storage engine for fast fulltext search with MySQL.</span>
    </a>
  </h1>

      <div class="facebook-buttons">
      <fb:like href="http://www.facebook.com/pages/mroonga/238184682903165"
               layout="standard"
               width="290"></fb:like>
    </div>
    <div class="other-language-links">

    <ul>
      <li><a href="../../ja/docs/developer/release.html" title="日本語">日本語</a></li>
    </ul>
  </div>
</div>
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="coding_style.html" title="9.3. コーディングスタイル"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="debug.html" title="9.1. How to debug"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Mroonga v9.11 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../developer.html" accesskey="U">9. Developer’s guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="release-procedure">
<h1>9.2. Release procedure<a class="headerlink" href="#release-procedure" title="Permalink to this headline">¶</a></h1>
<div class="section" id="requirements">
<h2>9.2.1. Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Here is the requirements about release procedure.</p>
<ul class="simple">
<li><p>Debian GNU/Linux (sid)</p></li>
<li><p>Use zsh as user shell</p></li>
</ul>
<p>Use the following working directories.</p>
<ul class="simple">
<li><p>MROONGA_DIR=$HOME/work/mroonga</p></li>
<li><p>MROONGA_CLONE_DIR=$HOME/work/mroonga/mroonga.clean</p></li>
<li><p>MROONGA_GITHUB_COM_PATH=$HOME/work/mroonga/mroonga.github.com</p></li>
<li><p>CUTTER_DIR=$HOME/work/cutter</p></li>
<li><p>CUTTER_SOURCE_PATH=$HOME/work/cutter/cutter</p></li>
<li><p>GROONGA_SOURCE_PATH=$HOME/work/groonga/groonga.clean</p></li>
</ul>
</div>
<div class="section" id="setup-build-environment">
<h2>9.2.2. Setup build environment<a class="headerlink" href="#setup-build-environment" title="Permalink to this headline">¶</a></h2>
<p>Install the following packages:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% sudo apt-get install -V ruby mecab libmecab-dev gnupg2 dh-autoreconf python-sphinx bison
</pre></div>
</div>
<p>We use <a class="reference external" href="https://www.vagrantup.com/">Vagrant</a> for building deb or rpm packages and expect that Virtualbox package is already installed. If not, please install it in the following steps:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% cat /etc/apt/sources.list
deb http://ftp.jp.debian.org/debian/ sid main contrib
deb-src http://ftp.jp.debian.org/debian/ sid main contrib
% sudo apt-get update
% sudo apt-get install virtualbox
</pre></div>
</div>
</div>
<div class="section" id="bump-version">
<h2>9.2.3. Bump version<a class="headerlink" href="#bump-version" title="Permalink to this headline">¶</a></h2>
<p>Bump version to the latest release:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make update-version NEW_VERSION_MAJOR=9 NEW_VERSION_MINOR=1 NEW_VERSION_MICRO=0
</pre></div>
</div>
</div>
<div class="section" id="describe-the-changes">
<h2>9.2.4. Describe the changes<a class="headerlink" href="#describe-the-changes" title="Permalink to this headline">¶</a></h2>
<p>Summarize recent changes since the previous release into <code class="docutils literal notranslate"><span class="pre">doc/source/news.txt</span></code>.
This summary is also used in release note.</p>
<p>Execute the following command to collect change logs since the previous version:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% git log -p --reverse $(git tag | tail -1)..
</pre></div>
</div>
<p>Search the logs by <code class="docutils literal notranslate"><span class="pre">^commit</span></code>, and pick up collect remarkable changes.</p>
<p>Should be included</p>
<ul class="simple">
<li><p>The changes which affect to users</p></li>
<li><p>The changes which broke compatibility</p></li>
</ul>
<p>Shoud not be included</p>
<ul class="simple">
<li><p>The changes which doesn’t affect to users (Internal source code changes or refactoring)</p></li>
</ul>
</div>
<div class="section" id="generate-configure-script">
<h2>9.2.5. Generate configure script<a class="headerlink" href="#generate-configure-script" title="Permalink to this headline">¶</a></h2>
<p>Because of master branch doesn’t include configure script, then it is required to generate configure script for building.</p>
<p>Execute <code class="docutils literal notranslate"><span class="pre">autogen.sh</span></code> with the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% sh autogen.sh
</pre></div>
</div>
<p>It generates <code class="docutils literal notranslate"><span class="pre">configure</span></code> script.</p>
</div>
<div class="section" id="execute-configure-script">
<h2>9.2.6. Execute configure script<a class="headerlink" href="#execute-configure-script" title="Permalink to this headline">¶</a></h2>
<p>For generating <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, execute the <code class="docutils literal notranslate"><span class="pre">configure</span></code> script.</p>
<p>Execute with the following options for the release:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% ./configure \
    --enable-document \
    --prefix=/tmp/local \
    --with-launchpad-uploader-pgp-key=(Launchpadに登録したkeyID) \
    --with-mroonga-github-com-path=$MROONGA_GITHUB_COM_PATH \
    --with-cutter-source-path=$CUTTER_SOURCE_PATH \
    --with-groonga-source-path=$GROONGA_SOURCE_PATH \
    --with-mysql-source=(The directory of MySQL source code) \
    --with-mysql-build=(The build directory of MySQL) \
    --with-mysql-config=(The path to mysql_config command)
</pre></div>
</div>
<p>See <a class="reference internal" href="../install/others.html"><span class="doc">Others</span></a>  for the details of <code class="docutils literal notranslate"><span class="pre">--with-mysql-source</span></code> option.</p>
</div>
<div class="section" id="check-whether-you-can-upload-packages">
<h2>9.2.7. Check whether you can upload packages<a class="headerlink" href="#check-whether-you-can-upload-packages" title="Permalink to this headline">¶</a></h2>
<p>Check whether you can login to packages.groonga.org as packages user.</p>
<p>You can check with the following command whether you can login:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% ssh packages@packages.groonga.org
</pre></div>
</div>
<p>If you can’t login to packages.groonga.org, you must be registered ssh public key.</p>
</div>
<div class="section" id="execute-make-update-latest-release">
<h2>9.2.8. Execute make update-latest-release<a class="headerlink" href="#execute-make-update-latest-release" title="Permalink to this headline">¶</a></h2>
<p>Execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">update-latest-release</span></code> command with OLD_RELEASE_DATE, NEW_RELEASE_DATE.</p>
<p>When 9.09 release, we executed the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make update-latest-release OLD_RELEASE=9.09 OLD_RELEASE_DATE=2019-09-27 NEW_RELEASE_DATE=2019-10-30
</pre></div>
</div>
<p>This command updates some html files (which is used for web sites of Mroonga - index.html,ja/index.html) and the version of spec file or debian/changelog entry.</p>
</div>
<div class="section" id="tagging-for-release">
<h2>9.2.9. Tagging for release<a class="headerlink" href="#tagging-for-release" title="Permalink to this headline">¶</a></h2>
<p>Execute the following command for tagging:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make tag
% git push --tags origin
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After tagging for the release, execute <code class="docutils literal notranslate"><span class="pre">configure</span></code> script. This tag information is reflected when generating the documents.</p>
</div>
</div>
<div class="section" id="upload-archive-files">
<h2>9.2.10. Upload archive files<a class="headerlink" href="#upload-archive-files" title="Permalink to this headline">¶</a></h2>
<p>Then, create archive file (<code class="docutils literal notranslate"><span class="pre">tar.gz</span></code>) for distribution:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make dist
</pre></div>
</div>
<p>Change working directory to <code class="docutils literal notranslate"><span class="pre">packages/source</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% cd packages/source
</pre></div>
</div>
<p>Execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">download</span></code> for syncing with the upstream:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make download
</pre></div>
</div>
<p>Execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">archive</span></code> for generating source archive:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make archive
</pre></div>
</div>
<p>Execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">upload</span></code> for uploading archive file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make upload
</pre></div>
</div>
<p>As a result, <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> archive file is available from <a class="reference external" href="http://packages.groonga.org/source/mroonga/">http://packages.groonga.org/source/mroonga/</a>.</p>
</div>
<div class="section" id="create-packages-for-the-release">
<h2>9.2.11. Create packages for the release<a class="headerlink" href="#create-packages-for-the-release" title="Permalink to this headline">¶</a></h2>
<p>Create Linux and Windows packages.</p>
<div class="section" id="debian">
<h3>9.2.11.1. Debian<a class="headerlink" href="#debian" title="Permalink to this headline">¶</a></h3>
<p>Change working directory to <code class="docutils literal notranslate"><span class="pre">apt</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% cd apt
</pre></div>
</div>
<p>Execute the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make download
% make build
% make upload
</pre></div>
</div>
<p>After uploading the packages, update sign/metadata. See Groonga’s release procedure about details.</p>
</div>
<div class="section" id="debian-derivatives-ubuntu">
<h3>9.2.11.2. Debian derivatives(Ubuntu)<a class="headerlink" href="#debian-derivatives-ubuntu" title="Permalink to this headline">¶</a></h3>
<p>For Ubuntu, packages are provided by PPA on launchpad.net.</p>
<p>Change working directory to <code class="docutils literal notranslate"><span class="pre">ubuntu</span></code> and execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">upload</span></code> command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% cd packages/ubuntu
% make upload
</pre></div>
</div>
<p>When upload packages was succeeded, package build process is executed on launchpad.net. Then build result is notified via E-mail.
You can install packages via Groonga PPA on launchpad.net:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* https://launchpad.net/~groonga/+archive/ubuntu/ppa
</pre></div>
</div>
</div>
<div class="section" id="red-hat-derivatives">
<h3>9.2.11.3. Red Hat derivatives<a class="headerlink" href="#red-hat-derivatives" title="Permalink to this headline">¶</a></h3>
<p>Change working directory to <code class="docutils literal notranslate"><span class="pre">yum</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% cd apt
</pre></div>
</div>
<p>Execute the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% make download
% make build
% make upload
</pre></div>
</div>
<p>After uploading the packages, update sign/metadata. See Groonga’s release procedure about details.</p>
</div>
<div class="section" id="windows">
<h3>9.2.11.4. Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h3>
<p>For windows packages, we use <a class="reference external" href="https://ci.appveyor.com/project/groonga/mroonga">AppVeyor CI</a> artifacts files.</p>
</div>
</div>
<div class="section" id="upload-documents">
<h2>9.2.12. Upload documents<a class="headerlink" href="#upload-documents" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Clone mroonga.github.com repository</p></li>
<li><p>Execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">update-document</span></code></p></li>
<li><p>Commit changes in mroonga.github.com repository &amp;&amp; push them</p></li>
</ol>
</div>
<div class="section" id="announce-release-for-mailing-list">
<h2>9.2.13. Announce release for mailing list<a class="headerlink" href="#announce-release-for-mailing-list" title="Permalink to this headline">¶</a></h2>
<p>Send release announce for each mailing list</p>
<ul class="simple">
<li><p><a class="reference external" href="mailto:ml&#37;&#52;&#48;mysql&#46;gr&#46;jp">ml<span>&#64;</span>mysql<span>&#46;</span>gr<span>&#46;</span>jp</a> for Japanese</p></li>
<li><p><a class="reference external" href="mailto:groonga-dev&#37;&#52;&#48;lists&#46;osdn&#46;me">groonga-dev<span>&#64;</span>lists<span>&#46;</span>osdn<span>&#46;</span>me</a> for Japanese</p></li>
<li><p><a class="reference external" href="mailto:groonga-talk&#37;&#52;&#48;lists&#46;sourceforge&#46;net">groonga-talk<span>&#64;</span>lists<span>&#46;</span>sourceforge<span>&#46;</span>net</a> for English</p></li>
</ul>
</div>
<div class="section" id="announce-release-for-twitter">
<h2>9.2.14. Announce release for twitter<a class="headerlink" href="#announce-release-for-twitter" title="Permalink to this headline">¶</a></h2>
<p>Click Tweet link in Mrooga blog entry. You can share tweet about latest release.
If you use tweet link, title of release announce and URL is embedded into your tweet.</p>
<p>Execute sharing tweet in Japanese and English version of blog entry.
Note that this tweet should be done when logged in by <code class="docutils literal notranslate"><span class="pre">groonga</span></code> account.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9.2. Release procedure</a><ul>
<li><a class="reference internal" href="#requirements">9.2.1. Requirements</a></li>
<li><a class="reference internal" href="#setup-build-environment">9.2.2. Setup build environment</a></li>
<li><a class="reference internal" href="#bump-version">9.2.3. Bump version</a></li>
<li><a class="reference internal" href="#describe-the-changes">9.2.4. Describe the changes</a></li>
<li><a class="reference internal" href="#generate-configure-script">9.2.5. Generate configure script</a></li>
<li><a class="reference internal" href="#execute-configure-script">9.2.6. Execute configure script</a></li>
<li><a class="reference internal" href="#check-whether-you-can-upload-packages">9.2.7. Check whether you can upload packages</a></li>
<li><a class="reference internal" href="#execute-make-update-latest-release">9.2.8. Execute make update-latest-release</a></li>
<li><a class="reference internal" href="#tagging-for-release">9.2.9. Tagging for release</a></li>
<li><a class="reference internal" href="#upload-archive-files">9.2.10. Upload archive files</a></li>
<li><a class="reference internal" href="#create-packages-for-the-release">9.2.11. Create packages for the release</a><ul>
<li><a class="reference internal" href="#debian">9.2.11.1. Debian</a></li>
<li><a class="reference internal" href="#debian-derivatives-ubuntu">9.2.11.2. Debian derivatives(Ubuntu)</a></li>
<li><a class="reference internal" href="#red-hat-derivatives">9.2.11.3. Red Hat derivatives</a></li>
<li><a class="reference internal" href="#windows">9.2.11.4. Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upload-documents">9.2.12. Upload documents</a></li>
<li><a class="reference internal" href="#announce-release-for-mailing-list">9.2.13. Announce release for mailing list</a></li>
<li><a class="reference internal" href="#announce-release-for-twitter">9.2.14. Announce release for twitter</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="debug.html"
                        title="previous chapter">9.1. How to debug</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="coding_style.html"
                        title="next chapter">9.3. コーディングスタイル</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="coding_style.html" title="9.3. コーディングスタイル"
             >next</a> |</li>
        <li class="right" >
          <a href="debug.html" title="9.1. How to debug"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Mroonga v9.11 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../developer.html" >9. Developer’s guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2020, Mroonga Project.
    </div>
      <script src="http://connect.facebook.net/en_US/all.js"></script>

    <script>
      FB.init({
         appId  : null,
         status : true, // check login status
         cookie : true, // enable cookies to allow the server to access the session
         xfbml  : true  // parse XFBML
      });
    </script>
  </body>

</html>